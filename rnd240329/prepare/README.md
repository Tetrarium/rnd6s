[Наверх](..)

# Основы

## Unit - тестирование

Unit-тестирование - автоматические тесты.

Автоматический тест - это код, который написан, чтобы проверять рабочий код проекта.

Самый простой вариант - ручное тестирование. Например, зашли на сайт, заполнили форму, нажали на кнопку, посмотрели что происходит. 

Зачастую, таких ситуаций очень много и проверять нужно по многу раз. Сложность приложения сильно увеличивается, изменения могут затронуть несколько функционалов, и поэтому приложение приходится тестировать польностью, чтобы проверить, что все работает надежно. Эта рутина занимает много времени. Притом, что ручная проверка единоразово проще, быстрее и дешевле экономически, для многократного повторения это оказывается дороже. Поэтому лучше рутинную проверку кода автоматизировать. Чем больше покрытие кода тестами, тем ниже риск того, что при добавлении какого-то нового модуля все приложение сломается.

Чем больше автоматизированного тестирования, тем проще поддерживать код и желательно, чтобы весь проект был покрыт тестами.

### Подходы
Есть готовый проект, и вы хотите увеличить его стабильность и надежность - можно написать тесты, которые проверяют уже существующий функционал.

Другой подход, это 
`TDD` (Test Drivin Development) - сначала пишем тест и только потом пишем код.

Когда вы вносите изменения в код, лучше, чтобы изначально запустили тест перед тем, как будете помещать код в репозиторий. Таким образом вы будете иметь гарантию, что код помещаемый в общуюю ветку проекта изначально работоспособно.

## Jest

`Jest` - Фреймворк для тестирования JS.

Работает с проектами, использующими `Babel`, `TypeScript`, `Node`, `React`, `Angular`, `Vue` и многое другое.

### 1. Установка

Помимо пакета `Jest` подключим `Babel`, для того чтобы транспилировать новый код JS в старый

1.1. Инициализируем проект

`npm init`

1.2. Устанавливаем пакет `Jest`

`npm install --save-dev jest`

1.3. Подключим пакет `babel-jest`

`npm install --save-dev babel-jest`

1.4. Для работы с `babel` поттебуется соответствующий пакет - `@babel/core`, `@babel/cli` и настройк env для транспиляции из ES6 в более ранние `@babel/preset-env`

`npm install --save-dev @babel/core @babel/cli @babel/preset-env`

1.5. Устанавливае `core-js`

`npm install core-js`

### 2. Настройка

2.1. Для настройки babel создадим в корне проекта файл `.babelrc` и добавим в него настройки

```json
{
  "presets": [
    [
      "@babel/preset-env",
      {
        "useBuiltIns": "usage",
        "corejs": 3
      }
    ]
  ]
}
```

### 3. Структура теста

Познакомимся с основной структурой теста
Для работы сделаем папку `test` в корне проекта, в которой будем писать тесты

[Ссылка на `test`](./starting/test/)

Для запуска теста пропишем команду в поле `script` в `package.json`:

```json
...,
"scripts": {
  "test": "jest"
},
...
```

Далее запускаем командой в консоле

`npm test`

### 4. Jest и ESLint

4.1. Установим ESLint

`npm install --save-dev eslint`

4.2. Настроим ESLint

- конфигурируем ESLint

`npm init @eslint/config`

- Для запуска ESLint пропишем команду в поле `script` в `package.json`:

```json
...
"lint": "eslint .",
...
```

- Запускаем eslint

`npm run lint`


Как правило, jest тесты распологают в том же файле, что и тестируемый, и должен быть рядом с этим файлом подкаталог __tests__


### Рекомендации по написанию тестов
 - не забываем функцию `expect`. Без нее тест будет проходить с положительным результатом
 - не использовать конструкции `if` и `for` - тест должен быть максимально линейным. Чем проще тест тем лучше
 - не следует использовать несколько `expect` в рамках тестов - под каждую задачу пишем свой тест
